---
title: "[DevOps] 初學開發維運00"
date: 2021-09-22T11:11:00+08:00
lastmod: 2021-09-22T11:11:00+08:00
draft: true
tags: ["docker", "k8s", "CI/CD"]
categories: ["DevOps"]
author: "tigernaxo"

autoCollapseToc: false
---
說到 DevOps 必須先從單體式架構(Monolithic Architecture)和微服務架構(Microservices Architecture)開始說起：

# 單體式架構
一個應用程式(AP)會由不同的服務所構成，
以前後端分離的應用程式而言，
不算進資料庫的話，就需要部屬前端靜態網站資源、Web API 這兩種服務。

傳統應用程式負載增加時，應用程式整體架構可以進行如下調整，
環境可以是實體機器、虛擬機器(Virtual Machine)、抑或是容器(Container)...
 - **橫向擴展**：增加**同一環境**(ex: AP Server)上**可用硬體資源**(CPU、MEMORY、Disk...)。
 - **縱向擴展**：增加**提供服務的環境** (ex: 第二台 AP Server 等等...)，好處是有了**備援機制**，可以達成**負載平衡**。

而不論是橫向或縱向擴展，一旦所有的服務都在同一個環境內執行，就會有下面的缺點：
 - 建立環境時需調整環境相容性來支持每個緊密連結的服務。
 - 每次更版都需要手動部屬，瑣碎麻煩。
 - 負載突增時難以快速釐清區是哪個服務出現問題。
 - 服務出錯時會影響其他服務。

# 微服務架構
微服務就是為了實現**服務隔離**而出現。
概念是將一個應用程式之下**緊密連結(耦合性強)**的服務拆成許多**連結鬆散**且可**獨立部署**的**小型服務**，
小型服務之間透過 HTTP、gRPC... 等通訊協定串聯訊息，構成複雜的應用程式。有許多好處：
 - **擴充性**：可針對負載需求較高的元件進行擴充，避免擴充整個應用程式造成資源(或效能)浪費。資源需求變動的時候也可以自動擴增/縮減 Auto-Scaling。
 - **安全性**：由於服務被隔離開獨立運作，更容易找出發生錯誤的服務，且避免單一服務出錯或超載影響整個應用程式。
 - **敏捷性**：拆成為服務的專案更適合敏捷開發，也因為拆成可獨立部屬的小型服務，負責不同小型服務的團隊可以使用不同的技術棧。
且修改微服務架構下元件(patch、新增元件功能)的時候不需要觸碰到整個應用程式。

# 微服務與容器
微服務架構的核心技術就是容器 (Container)，容器和虛擬機 (VM) 的不同點在於：
VM 將服務從作業系統層面進行隔離，不同服務有各自獨立的作業系統，因此啟動速度、硬體資源都需要考慮到各自的作業系統；
容器則將執行環境在應用程式層面上隔離，不同服務彼此共用同一個作業系統，
因此相較於 VM，容器的優點是耗用的資源少，啟動速度快；
但由於容器共用作業系統和硬體，因此安全性較差，各個服務不能使用不同的作業系統。

# 容器管理平台
目前最主流的容器軟體是 Docker，容器管理平台是 K8S(Kubernetes)

當負載增加就需要擴充硬體資源來因應，
把應用程式部屬到兩台以上的
微服務 + Kubernets 
於K8S 的微服務開發框架，解決架構管理的複雜問題，讓開發人員專注於應用開發。 // todo 改

# 回到 DevOps
傳統流程大約是這樣子的： (todo 修改)
程式開發：由程式設計師開發程式。
測試：開發到一個階段由開發者或測試人員測試、撰寫測試報告。
系統部屬上線：寫腳本建立程式環境、部屬程式。
維運：軟體環境調校和軟體維護作業。

DevOps是什麼？
傳統的產品開發、測試、維運各自作業，
每次程式開發上線的工作流程大同小異(測試、部屬...)且必須人工作業，

DevOps 透過微服務架構整合 Development(開發)、Operation(維運)，
建立自動部屬、自動測試之類的自動化流程，
可大幅縮短開發交付到部屬上線的流程，藉此更精準快速回應市場需求並大幅減少人力成本，
且因為微服務開發框架從根本解決架構管理的複雜問題，
透過自動化流程將維運工程師從瑣碎日常事務當中解放出來，
，讓開發人員可以更專注於應用開發、其他更有價值的工作、學習新技術。

# 硬體
## 硬體資源擴充與服務執行環境隔離

傳統維運的手法？ shell?
#  CICD
上程式的流程自動化

導入現代化 DevOps 帶來什麼好處
方便
安全問題：工程師將編譯的檔案直接放上伺服器，但是程式碼沒有進入版控，會造成混亂。

# Reference
- [第 11 屆 iThome 鐵人賽-就是「懶」才更需要重視DevOps](https://ithelp.ithome.com.tw/users/20120491/ironman/2538)
- [何謂微服務 - 台灣|IBM](https://www.ibm.com/tw-zh/cloud/learn/microservices)