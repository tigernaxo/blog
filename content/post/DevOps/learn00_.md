---
title: "[DevOps] 初學開發維運00"
date: 2021-09-22T11:11:00+08:00
lastmod: 2021-09-22T11:11:00+08:00
draft: true
tags: ["docker", "k8s", "CI/CD"]
categories: ["DevOps"]
author: "tigernaxo"

autoCollapseToc: false
---

DevOps 全名為 Development & Operations，
是整合開發與運維的思維模式。
由於每次程式開發上線的工作流程大同小異(測試、部屬...)，
因此自動部屬、自動測試之類種種流程自然就被建立出來。
這些自動化流程將維運工程師從瑣碎日常事務當中解放出來，
讓工程師專注在其他更有價值的工作、學習新技術。

# 單體式架構與微服務
一個應用程式(AP)會由不同的服務所構成，
以前後端分離的應用程式而言，
不算進資料庫的話，就需要部屬前端靜態網站資源、Web API 這兩種服務。

傳統應用程式負載增加時，應用程式整體架構可以進行的調整：
 - **橫向擴展**：增加同一環境(ex: AP Server)上可用硬體資源(CPU、MEMORY、Disk...)。
 - **縱向擴展**：增加提供服務的環境 (ex: 第二台 AP Server 等等...)，好處是有了**備援機制**，可以達成**負載平衡**。

而不論是橫向或縱向擴展，一旦所有的服務都在同一個環境內執行，就會有下面的缺點：
 - 建立環境時需調整環境相容性來支持每個緊密連結的服務。
 - 每次更版都需要手動部屬，瑣碎麻煩。
 - 負載突增時難以快速釐清區是哪個服務出現問題。

微服務就是為了實現**服務隔離**而出現。
概念是將一個應用程式之下**緊密連結(耦合性強)**的服務拆成許多**連結鬆散**且可**獨立部署**的**小型服務**，
微服務有許多好處：
 - 修改元件(patch、新增元件功能)的時候不需要觸碰到整個應用程式。
 - 因為拆成可獨立部屬的小型服務了，負責不同小型服務的團隊可以使用不同的技術棧。
 - 可以進一步針對負載需求較高的原件進行擴充，避免擴充整個應用程式造成資源(或效能)浪費。
 - 更容易找出發生錯誤的服務。

所說的環境可以是 一台實體機器、虛擬機器(Virtual Machine)、抑或是容器(Container)


以服務隔離的觀點來說，
當部屬應用程式的時候就需要把前後端程式部屬到各自的機器上，

當負載增加就需要擴充硬體資源來因應，
把應用程式部屬到兩台以上的
微服務 + Kubernets 
於K8S 的微服務開發框架，解決架構管理的複雜問題，讓開發人員專注於應用開發。 // todo 改
擴充性、敏捷性、安全性。


# 硬體
## 硬體資源擴充與服務執行環境隔離
傳統上會將多個服務部屬在同一台機器上。
縱向擴充：在同一台機器上加大 CPU、RAM、Disk
我們從實體機中切出「虛擬機」，同時讓一台「虛擬機」裡面運行多個專案或服務，但因為資金不足所以「虛擬機」也無法開太多台，只好選擇加大「虛擬機」規格(例如：CPU、Memory、Disk等)，但是這樣的情況往往在虛擬機異常時，上面所運行的服務與專案，全數受到影響。
橫向擴充：增加提供服務的機器數量，可以同時實現備援、負載平衡(Load Balance)的效果。
改採用另外一種架構「不只有一台虛擬機提供服務，並且每台虛擬機都有各自的備援機器」，當線上服務的機器異常時，可以在短時間切換至「備援機」，以減少因機器異常而導致的影響，甚至透過橫向擴充的方式，實現連線LoadBalance，降低「虛擬機」的Loading。
但是如果負載暴增，因為相關的服務都部屬在同一台機器上，故無法快速找出出問題的服務，
微服務(micro service)的概念出現之後，服務被隔離在各自的執行環境內，可以是虛擬機器或容器。

todo: 什麼是維運
為什麼需要維運
傳統維運的手法？ shell?
#  CICD
上程式的流程自動化

導入現代化 DevOps 帶來什麼好處
方便
安全問題：工程師將編譯的檔案直接放上伺服器，但是程式碼沒有進入版控，會造成混亂。

# Reference
- [第 11 屆 iThome 鐵人賽-就是「懶」才更需要重視DevOps](https://ithelp.ithome.com.tw/users/20120491/ironman/2538)
- [何謂微服務 - 台灣|IBM](https://www.ibm.com/tw-zh/cloud/learn/microservices)